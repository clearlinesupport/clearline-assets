/*
  File: calculator.js
  Description: Simple workstation quote calculator.
  Author: Generated by OpenAI Codex on 2025-06-07
  License: Â© 2025 Clearline Field Systems. All rights reserved.
*/

/**
 * calculateTotal
 * Sum the line totals for selected items.
 * @param {{price:number, qty:number}[]} items
 * @returns {number}
 */
function calculateTotal(items) {
    if (!Array.isArray(items)) {
        return 0;
    }
    return items.reduce((sum, item) => {
        const qty = Number(item.qty);
        const price = Number(item.price);
        if (Number.isNaN(qty) || Number.isNaN(price) || qty <= 0) {
            return sum;
        }
        return sum + price * qty;
    }, 0);
}

/**
 * initCalculator
 * Bind DOM events to update total on form input.
 * Expects inputs with data-price attribute and qty input fields.
 */
function initCalculator() {
    const form = document.getElementById('quote-form');
    const totalEl = document.getElementById('quote-total');

    if (!form || !totalEl) {
        return;
    }

    function updateTotal() {
        const items = Array.from(form.querySelectorAll('[data-price]')).map(el => ({
            price: el.getAttribute('data-price'),
            qty: el.value
        }));
        const total = calculateTotal(items);
        totalEl.textContent = `$${total.toFixed(2)}`;
    }

    form.addEventListener('input', updateTotal);
    updateTotal();
}

if (typeof module !== 'undefined' && module.exports) {
    module.exports = { calculateTotal, initCalculator };
}

if (typeof window !== 'undefined') {
    window.addEventListener('DOMContentLoaded', initCalculator);
}
